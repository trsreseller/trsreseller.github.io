<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Product Details</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

<style>
body{margin:0;font-family:Arial;background:#f6f6f6}
.header{background:#111;color:#fff;padding:12px;text-align:center}
.slider img{width:100%;height:260px;object-fit:cover}
.content{padding:12px}
.price{color:#d32f2f;font-size:20px;font-weight:bold}
.btn{display:block;background:#25D366;color:#fff;
text-align:center;padding:12px;border-radius:6px;
text-decoration:none;margin-top:15px;font-size:16px}
.login-msg{color:#999;margin-top:10px}
iframe{width:100%;height:220px;border-radius:6px}
</style>
</head>

<body>

<div class="header">Product Details</div>

<div class="slider" id="slider"></div>

<div class="content">
  <h2 id="name"></h2>
  <div id="priceBox"></div>
  <div id="videoBox"></div>

  <a id="orderBtn" class="btn" target="_blank">Order via WhatsApp</a>
</div>

<script>
firebase.initializeApp({
  apiKey: "YOUR_API_KEY",
  authDomain: "YOUR_PROJECT.firebaseapp.com",
  projectId: "YOUR_PROJECT"
});

const db=firebase.firestore();
const params=new URLSearchParams(location.search);
const id=params.get("id");
const loggedIn = localStorage.getItem("resellerLogin")==="true";

async function load(){
  const doc=await db.collection("products").doc(id).get();
  const p=doc.data();

  // Images
  const slider=document.getElementById("slider");
  p.images.forEach(img=>{
    slider.innerHTML+=`<img src="${img}">`;
  });

  document.getElementById("name").innerText=p.name;

  // Price
  if(loggedIn){
    document.getElementById("priceBox").innerHTML=
      `<div class="price">à§³ ${p.price}</div>`;
  }else{
    document.getElementById("priceBox").innerHTML=
      `<div class="login-msg">Login to see price</div>`;
  }

  // Video
  if(p.video){
    document.getElementById("videoBox").innerHTML=
      `<iframe src="${p.video.replace("watch?v=","embed/")}"
       allowfullscreen></iframe>`;
  }

  // WhatsApp Order
  const msg=`Order Request:%0A${p.name}%0APrice: ${p.price}`;
  document.getElementById("orderBtn").href=
    `https://wa.me/8801XXXXXXXXX?text=${msg}`;
}

load();
</script>

</body>
</html>
