<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>TRS Reseller | Shop</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore-compat.js"></script>

<style>
body{margin:0;font-family:Arial;background:#f5f5f5}
header{background:#111;color:#fff;padding:12px;text-align:center}
.container{padding:12px}
.product{background:#fff;border-radius:8px;padding:10px;margin-bottom:12px}
.product img{width:100%;border-radius:6px}
.price{color:#e91e63;font-size:18px;font-weight:bold}
.btn{display:block;text-align:center;background:#111;color:#fff;padding:10px;border-radius:6px;text-decoration:none;margin-top:8px}
.login-msg{color:red;font-weight:bold;text-align:center;margin:15px 0}
footer{background:#111;color:#fff;text-align:center;padding:15px;margin-top:20px}
</style>
</head>

<body>

<header>
<h2>TRS SHOP</h2>
<p>Reseller Based Wholesale Platform</p>
</header>

<div class="container" id="productList">
Loading products...
</div>

<footer>
<p>Â© 2025 TRS Reseller Platform</p>
</footer>

<script>
/* ðŸ”¥ FIREBASE CONFIG (same as before) */
firebase.initializeApp({
  apiKey: "YOUR_API_KEY",
  authDomain: "YOUR_PROJECT.firebaseapp.com",
  projectId: "YOUR_PROJECT"
});

const auth = firebase.auth();
const db = firebase.firestore();

let currentUserApproved = false;

/* ðŸ” CHECK LOGIN & APPROVAL */
auth.onAuthStateChanged(async user=>{
  if(user){
    const snap = await db.collection("resellers").doc(user.uid).get();
    if(snap.exists && snap.data().approved === true){
      currentUserApproved = true;
    }
  }
  loadProducts();
});

/* ðŸ›’ LOAD PRODUCTS */
async function loadProducts(){
  const box = document.getElementById("productList");
  box.innerHTML = "";

  const snap = await db.collection("products").get();
  snap.forEach(doc=>{
    const p = doc.data();
    box.innerHTML += `
      <div class="product">
        <img src="${p.image}">
        <h3>${p.name}</h3>
        ${
          currentUserApproved 
          ? `<div class="price">à§³ ${p.price}</div>
             <a class="btn" href="order.html">Order Now</a>`
          : `<div class="login-msg">
               ðŸ”’ Price visible for approved resellers only  
               <br><a href="reseller-login.html">Login Here</a>
             </div>`
        }
      </div>
    `;
  });
}
</script>

</body>
</html>
